<button id="theme_switch">Toggle Theme</button>
<script is:inline>
    function setDarkMode(document) {
        // Obtener el estado actual del modo oscuro desde localStorage
        let darkmode = localStorage.getItem("darkmode") || "deactivated";

        // Establecer el tema inicial en el atributo `data-theme`
        const theme = darkmode === "active" ? "dark" : "light";
        document.documentElement.dataset.theme = theme;

        // Referencia al botón
        const themeSwitch = document.getElementById("theme_switch");

        // Función para habilitar el modo oscuro
        const enableDarkMode = () => {
            document.body.classList.add("dark");
            localStorage.setItem("darkmode", "active");
        };

        // Función para deshabilitar el modo oscuro
        const disableDarkMode = () => {
            document.body.classList.remove("dark");
            localStorage.setItem("darkmode", "deactivated");
        };

        // Aplicar el estado inicial del modo oscuro
        if (darkmode === "active") enableDarkMode();

        // Agregar un evento al botón para alternar entre modos
        themeSwitch?.addEventListener("click", () => {
            darkmode = localStorage.getItem("darkmode");
            darkmode === "active" ? disableDarkMode() : enableDarkMode();

            // Actualizar el atributo `data-theme` después del cambio
            const newTheme = darkmode === "active" ? "light" : "dark";
            document.documentElement.dataset.theme = newTheme;
        });
    }

    // Inicializar el modo oscuro
    setDarkMode(document);

    // Manejar el evento `astro:before-swap` para mantener el estado del tema
    document.addEventListener("astro:before-swap", (event) => {
        setDarkMode(event.newDocument);
    });
</script>
